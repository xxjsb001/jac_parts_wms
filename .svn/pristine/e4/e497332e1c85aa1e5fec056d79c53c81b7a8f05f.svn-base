package com.vtradex.wms.server.telnet.shell.receiving;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.vtradex.kangaroo.shell.PageableBaseShell;
import com.vtradex.wms.server.model.receiving.WmsASNStatus;
import com.vtradex.wms.server.web.filter.WmsWarehouseHolder;

/**
 * 
 * @category Shell
 * @author <a href="brofe.pan@gmail.com">潘宁波</a>
 * @version $Revision: 1.1.1.1 $Date: 2015/03/25 02:48:55 $
 */
public class WmsASNListShell extends PageableBaseShell {
	
	public static final String PAGE_ID = "wmsASNListShell";

	@Override
	public String[] getTableHeader() {
		return new String[]{"序号", "单据号/待收数量/收货数量"};
	}

	@Override
	public String getHql() {
		String hql = "select a.id, a.code || '/' || a.expectedQuantityBU || '/' || a.receivedQuantityBU from WmsASN a where 1=1" +
				" /~状态: AND a.status not in  ({状态})~/" +
				" /~仓库: AND a.warehouse.id = {仓库}~/";
		return hql;
	}

	@Override
	public String getNextShell() {
		Object[] rowData = (Object[])get(ROW_DATA_KEY);
		this.put("asn.id", rowData[0]);
		
		return WmsASNDetailShell.PAGE_ID;
	}

	@Override
	public Map<String, Object> getParams() {
		Map<String, Object> params = new HashMap<String, Object>();
		List<String> status = new ArrayList<String>();
		status.add(WmsASNStatus.RECEIVED);
		status.add(WmsASNStatus.CANCELED);
		status.add(WmsASNStatus.OPEN);
		params.put("状态", status);
		params.put("仓库", WmsWarehouseHolder.getWmsWarehouse().getId());
		return params;
	}

}
